CMAKE_MINIMUM_REQUIRED( VERSION 2.6 )
PROJECT( VKONTAKTE )
SET( QT_USE_QTNETWORK TRUE )
SET( QT_USE_QTSCRIPT TRUE )
SET (QT_USE_QTWEBKIT true)

ADD_QUTIMPLUGIN( "vkontakte" "src" )

SET_TARGET_PROPERTIES(vkontakte PROPERTIES COMPILE_FLAGS "-DLIBVKONTAKTE_LIBRARY")

FILE( GLOB PLUGINS RELATIVE "${CMAKE_CURRENT_SOURCE_DIR}/plugins" "${CMAKE_CURRENT_SOURCE_DIR}/plugins/*" )
LIST( REMOVE_ITEM PLUGINS .svn _svn )

FOREACH( PLUGIN ${PLUGINS} )
	STRING( TOUPPER ${PLUGIN} PLUGIN_NAME)
	OPTION( ${PLUGIN_NAME} "" ON )
	IF( NOT DEFINED "NO_${PLUGIN_NAME}" )
	MESSAGE( "+ vkontakte plugin '${PLUGIN_NAME}' added to build" )
	ADD_QUTIMPLUGIN( vkontakte${PLUGIN} "plugins/${PLUGIN}" )
	TARGET_LINK_LIBRARIES( vkontakte${PLUGIN} vkontakte )
	ELSE( NOT DEFINED "NO_${PLUGIN_NAME}" )
	MESSAGE( "- vkontakte plugin '${PLUGIN_NAME}' will be skipped" )
	ENDIF( NOT DEFINED "NO_${PLUGIN_NAME}" )
ENDFOREACH( PLUGIN )
